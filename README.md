# RFID 打卡系統

基於Arduino的RFID考勤/打卡系統，使用ESP8266微控制器搭配OLED顯示屏、RFID讀取器(MFRC522)、按鈕和蜂鳴器。

## 功能特色

- **RFID卡片讀取**: 讀取MIFARE Classic卡片/標籤的唯一ID
- **RFID卡片寫入**: 將自訂資料寫入RFID卡片
- **OLED顯示屏**: 顯示卡片資訊和系統狀態
- **按鈕控制**: 在讀取/寫入模式間切換
- **音效回饋**: 蜂鳴器提供成功/錯誤提示音
- **雙模式操作**: 透過按鈕在讀取和寫入模式間切換
- **WiFi控制**: 透過WiFi AP提供網頁控制界面
- **HTTP API**: 支援HTTP請求進行遠程控制

## 硬體元件

- **微控制器**: ESP8266 (NodeMCU/ESP-12F)
- **顯示器**: SSD1306 128x64 OLED (HW-364A相容)
- **RFID讀取器**: MFRC522模組
- **輸入**: 按鈕用於模式切換
- **輸出**: 蜂鳴器提供音效回饋
- **電源**: 3.3V供電 (注意: 不可接5V!)
- **網路**: WiFi AP (內建於ESP8266)

### 接腳連接

#### RC522 RFID模組
| RC522 腳位 | 應該接到 | GPIO | 說明 |
|----------|---------|------|------|
| **SDA (SS)** | D8 | GPIO15 | 從選擇腳位 (Slave Select) |
| **SCK** | D2 | GPIO4 | 序列時脈 (Serial Clock) |
| **MOSI** | D3 | GPIO0 | 主機輸出從機輸入 (Master Out Slave In) |
| **MISO** | D0 | GPIO16 | 主機輸入從機輸出 (Master In Slave Out) |
| **RST** | D1 | GPIO5 | 重置腳位 (Reset) |
| **3.3V** | 3.3V | - | 電源 (⚠️ 不能接 5V！) |
| **GND** | GND | - | 接地 |

#### OLED顯示屏
| OLED 腳位 | 應該接到 | GPIO | 說明 |
|----------|---------|------|------|
| **SDA** | D5 | GPIO14 | 資料線 (I2C) |
| **SCL** | D6 | GPIO12 | 時脈線 (I2C) |
| **VCC** | 3.3V | - | 電源 |
| **GND** | GND | - | 接地 |

#### 其他組件
| 組件 | 應該接到 | GPIO | 說明 |
|------|---------|------|------|
| **按鈕** | D7 | GPIO13 | 模式切換按鈕 (帶上拉電阻) |
| **蜂鳴器** | D4 | GPIO2 | 音效輸出 |

## 操作模式

### 讀取模式 (預設)
- 讀取RFID卡片資料
- 在OLED上顯示卡片UID和儲存的資料
- 顯示結果停留2秒後返回模式選擇畫面
- 將資料發送到序列監控視窗

### 寫入模式
- 將"HELLO_AVEI"寫入RFID卡片的第4區塊
- 確認寫入操作成功
- 顯示結果停留2秒後返回模式選擇畫面
- 為失敗的寫入提供錯誤回饋

## 使用方法

1. 給設備供電開機
2. 等待OLED顯示"Ready!"訊息
3. 按下按鈕在讀取/寫入模式間切換
4. 將RFID卡片放在讀取器上：
   - 在讀取模式：顯示卡片UID和儲存的資料
   - 在寫入模式：將預設文字寫入卡片
5. 操作完成後系統返回模式選擇

## 技術細節

- 使用軟體SPI進行RFID通訊
- 實現MFRC522協定進行卡片通訊
- 支援MIFARE Classic 1K卡片
- 使用預設驗證金鑰 (0xFFFFFFFFFFFF)
- 在卡片記憶體的第4區塊儲存資料
- 卡片讀取/寫入結果在螢幕上顯示2秒後自動返回模式選擇
- 操作完成後自動執行Halt指令停止與卡片通訊

## 相依套件

- U8g2函式庫用於OLED顯示
- ESP8266WiFi函式庫用於WiFi連接
- ESP8266WebServer函式庫用於HTTP服務
- 標準Arduino函式庫用於GPIO控制

## 故障排除

- **無法偵測RFID**: 檢查配線連接，確認MFRC522供電正常，確保使用3.3V電源
- **UID錯誤**: 清潔卡片表面，確保正確放置在讀取器上
- **寫入失敗**: 確認卡片相容性，檢查驗證金鑰
- **顯示問題**: 檢查OLED的I2C連接 (SDA/D5, SCL/D6)
- **接腳問題**: 確認所有接腳按照接腳連接表正確連接
- **電源問題**: 確保所有組件使用正確電壓 (特別是RFID模組不可接5V!)

## 序列埠除錯

系統以115200鮑率透過序列埠輸出除錯資訊：
- 初始化狀態
- 卡片UID
- 讀取/寫入操作
- 錯誤訊息

## WiFi AP 控制

此專案支援WiFi AP模式，允許通過網頁瀏覽器遠程控制RFID讀寫操作。

### WiFi 設定
- **SSID**: RFID-Punch-System
- **密碼**: 12345678
- **IP地址**: 192.168.4.1

### 使用方法
1. 將設備連接到名為 "RFID-Punch-System" 的WiFi網路
2. 在瀏覽器中訪問 `http://192.168.4.1`
3. 使用網頁界面進行RFID讀寫操作

### 網頁功能
- **模式設定**: 切換讀取/寫入模式
- **讀取卡片**: 讀取RFID卡片資料
- **寫入卡片**: 向RFID卡片寫入資料
- **狀態查詢**: 查看系統狀態

### HTTP API
- `/` - 主頁面
- `/read` - 讀取卡片資料
- `/write?data=資料` - 寫入資料到卡片
- `/mode?set=read|write` - 切換模式
- `/status` - 查詢系統狀態

## 自訂化

- 修改寫入模式中的`text`變數以儲存不同資料
- 更改驗證金鑰以增強安全性
- 調整顯示訊息以支援不同語言
- 加入更複雜的資料儲存方案
- 修改WiFi設定 (SSID和密碼)

## 授權

此專案採用開放原始碼，並以[MIT授權條款](LICENSE)提供。